\section{Introduction}

The video game Lumines was released in December 2004 in Japan for the PSP platform. The game was a major success for the developer Q Entertainment, and has since its original release been followed with a couple of sequels \cite{wiki:lumines}.

\begin{figure}[H]
    \centering
    \resizebox{0.7\textwidth}{!}{
    \begin{tikzpicture}
        \lummonowhite{0}{0}
        \lummonoblack{3}{0}
        \lumlwhite{6}{0}
        \lumlblack{9}{0}
        \lumh{12}{0}
        \lumx{15}{0}
    \end{tikzpicture}
    }
    \caption{The six pieces of lumines: M\{W,B\}, L\{W,B\}, H and X}
    \label{fig:pieces}
\end{figure}

Lumines is a two-dimensional grid game, in which a sequence of $2 \times 2$ dichromatic \textit{blocks} falls, and the user can rotate and shift the block before its bottom \text{cells} reaches other cells, \textit{terrain}, in the gameboard. When the block does reach existing terrain, it can no longer be shifted or rotated by the player. If both bottom cells of the block is supported by existing terrain, the block stays put on that terrain. Otherwise, the half of the block that is supported by terrain will fall down until it is. The player is then presented with the next block.

\begin{figure}[H]
    \centering
    \resizebox{0.7\textwidth}{!}{
    \begin{subfigure}[b]{0.45\linewidth}
        \resizebox{\linewidth}{!}{
        \begin{tikzpicture}
            \lumx{0}{4}
            \draw[thick, ->] (1,3.5) -- (1, 2.5);
            \lumx{0}{0}
            \draw [draw=none] rectangle (3, 7);
        \end{tikzpicture}
        \hspace{0.25cm}
        \begin{tikzpicture}
            \lumx{0}{2}
            \lumx{0}{0}
            \draw [draw=none] rectangle (3, 7);
        \end{tikzpicture}
        }
        \caption{}
    \end{subfigure}
    \hspace{0.05\linewidth}
    \begin{subfigure}[b]{0.45\linewidth}
        \resizebox{\linewidth}{!}{
        \begin{tikzpicture}
            \lumx{1}{4}
            \draw[thick, ->] (2,3.5) -- (2, 2.5);
            \lumx{0}{0}
            \draw [draw=none] rectangle (3, 7);
        \end{tikzpicture}
        \hspace{0.25cm}
        \begin{tikzpicture}
            \lumx{0}{0}
            \cellb{1}{2}
            \cellw{1}{3}
            \cellw{2}{0}
            \cellb{2}{1}
            \draw [draw=none] rectangle (3, 7);
        \end{tikzpicture}
        }
        \caption{}
    \end{subfigure}
    }
    \caption{Block behavior with and without supporting terrain}
\end{figure}

If at any point the player forms a monochromatic $2 \times 2$ square, all cells belonging to that square is \textit{marked}. Note that these squares may overlap, for example all cells within a monochromatic $2 \times 3$ rectangle is marked, since it consists of overlapping $2 \times 2$ monochromatic squares. At a regular pace a vertical \textit{sweep-line} scans the gameboard and removes all marked cells.

\begin{figure}[H]
    \centering
    \resizebox{0.7\textwidth}{!}{
        \begin{subfigure}[b]{.3\linewidth}
        \fbox{
        \begin{tikzpicture}
            \cellw{0}{0}
            \cellw{1}{0}
            \cellb{2}{0}
            \cellw{0}{1}
            \cellw{2}{1}
            \cellw{2}{2}
            \cellb{0}{5}
            \cellw{1}{5}
            \cellb{0}{6}
            \cellw{1}{6}
            \draw [draw=none] (0,0) rectangle (3, 8);
        \end{tikzpicture}
        }
        \end{subfigure}
        \begin{subfigure}[b]{.3\linewidth}
        \fbox{
        \begin{tikzpicture}
            \cellw{0}{0}
            \cellw{1}{0}
            \cellb{2}{0}
            \cellw{0}{1}
            \cellw{2}{1}
            \cellw{2}{2}
            \cellb{0}{2}
            \cellw{1}{1}
            \cellb{0}{3}
            \cellw{1}{2}
            \draw [draw=none] (0,0) rectangle (3, 8);
        \end{tikzpicture}
        }
        \end{subfigure}
        \begin{subfigure}[b]{.3\linewidth}
        \fbox{
        \begin{tikzpicture}
            \cellb{0}{2}
            \cellb{0}{3}
            \cellb{2}{0}
            \draw (0,0) [very thick, draw=black, fill=red] rectangle (2,2);
            \draw (1,1) [very thick, draw=black, fill=red] rectangle (3,3);
            \draw (1,1) [very thick, draw=black, fill=red] rectangle (2,2);
            \draw [draw=none] (0,0) rectangle (3, 8);
        \end{tikzpicture}
        }
        \end{subfigure}
    }
    \caption{Marking of $2 \times 2$ monochromatic squares (from \cite{lumines})}
\end{figure}

The version of Lumines found in the actual video games is played on a gameboard with 16 columns and 10 rows. The goal of the standard game mode in Lumines is to survive, to keep placing blocks inside the gameboard, for as long as possible and clear as much terrain as possible in the process. The blocks given to the player is generated randomly, and 3-block lookahead is provided. The game starts on partially filled gameboard, which varies in size depending on the difficulty level \cite{lumines}.

\subsection{Problem definition}
As is often the case with computational complexity analysis, our thesis will consider the generalized version of the game, which is played on a gameboard with $n$ rows and $m$ columns. Our thesis will seek to formalize and (to the necessary degree) simplify Lumines, and explore this new system's computational complexity characteristics. The thesis will focus on certain goals of the game by translating them into decision problems in this system.

The methodology used is standard procedure in the domain of computational complexity. At first we examine how easy it is to verify a given solution to our problem, which will tell us if the problem lies in NP. We will then try to find a suitable known NP-complete problem and reduce it to our problem, which in turn will tell us if the problem is NP-hard. If both these conditions are satisfied, it follows from definition that the problem is NP-complete. A brief review of this terminology is provided in \textbf{todo:background}.

While the sweep-line is undoubtedly an important characteristic of Lumines, we have decided to assume that all marked terrain is instantly cleared. We will also consider the offline version of the game, where the whole sequence of blocks is known beforehand, rather than the having the block types generated probabilistically. This is our two main simplifications, altough a more thorough is of course provided in the relevant parts of \textbf{todo:method}. The impact of these simplifications on how much the results can tell us about the actual games is considered in \textbf{todo:discussion}.

\subsection{Problem statement}
\begin{itemize}
        \item Is (standard mode) Lumines NP-complete?
        \item Are all game modes of Lumines equally hard?
\end{itemize}

\subsection{Motivation}

We find interest in analyzing Lumines because it is to our knowledge not very researched when it comes to computational complexity. Tetris, a similar puzzle game, has been more thoroughly examined in recent years, and it seems interesting to us how Lumines will compare. Knowing more about the computational complexity of the game can give us an understanding on what would be required for the development of an A.I, capable of solving the game. We also believe that the result of this study can help us understand more about the nature of computational complexity of video games in general, especially 2-dimensional grid games. With results from this and other reports on similar matters, one might be able to generalize and find a correlation between certain game characteristics and classes of computational complexity. 
